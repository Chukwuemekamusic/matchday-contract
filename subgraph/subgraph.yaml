specVersion: 1.3.0
indexerHints:
  prune: auto
schema:
  file: ./schema.graphql
dataSources:
  - kind: ethereum
    name: MatchDayBetV2
    network: base
    source:
      address: "0x1b048C7323C7c7FE910a5F0e08B36b0c715e8947"
      abi: MatchDayBetV2
      startBlock: 40551839
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.9
      language: wasm/assemblyscript
      entities:
        - Match
        - Bet
        - User
        - GlobalStats
        - MatchManager
        - Upgraded
        - ConfigUpdate
      abis:
        - name: MatchDayBetV2
          file: ./abis/MatchDayBetV2.json
      eventHandlers:
        # Match Lifecycle Events
        - event: MatchCreated(indexed uint256,string,string,string,uint256)
          handler: handleMatchCreated
        - event: BettingClosed(indexed uint256)
          handler: handleBettingClosed
        - event: MatchResolved(indexed uint256,uint8,uint256,uint256,uint256)
          handler: handleMatchResolved
        - event: BatchMatchesResolved(uint256[],uint8[])
          handler: handleBatchMatchesResolved
        - event: MatchCancelled(indexed uint256,string)
          handler: handleMatchCancelled
        - event: BatchMatchesCancelled(uint256[],string)
          handler: handleBatchMatchesCancelled

        # Match Control Events (V2)
        - event: MatchPaused(indexed uint256)
          handler: handleMatchPaused
        - event: MatchUnpaused(indexed uint256)
          handler: handleMatchUnpaused

        # Betting Events
        - event: BetPlaced(indexed uint256,indexed address,uint8,uint256,uint256)
          handler: handleBetPlaced

        # Claim Events
        - event: WinningsClaimed(indexed uint256,indexed address,uint256,uint256)
          handler: handleWinningsClaimed
        - event: RefundClaimed(indexed uint256,indexed address,uint256)
          handler: handleRefundClaimed
        - event: BatchWinningsClaimed(indexed address,uint256[],uint256)
          handler: handleBatchWinningsClaimed
        - event: BatchRefundsClaimed(indexed address,uint256[],uint256)
          handler: handleBatchRefundsClaimed

        # Admin Events
        - event: FeesWithdrawn(indexed address,uint256)
          handler: handleFeesWithdrawn
        - event: StakeLimitsUpdated(uint256,uint256)
          handler: handleStakeLimitsUpdated
        - event: PlatformFeeUpdated(uint256)
          handler: handlePlatformFeeUpdated
        - event: MatchManagerAdded(indexed address)
          handler: handleMatchManagerAdded
        - event: MatchManagerRemoved(indexed address)
          handler: handleMatchManagerRemoved
        - event: OwnershipTransferred(indexed address,indexed address)
          handler: handleOwnershipTransferred
        - event: UpgradesLocked()
          handler: handleUpgradesLocked
        - event: EmergencyPausedByManager(indexed address)
          handler: handleEmergencyPausedByManager

        # Proxy Upgrade Event
        - event: Upgraded(indexed address)
          handler: handleUpgraded
      file: ./src/match-day-bet-v-2.ts
